<!-- views/profile.ejs -->
<%
  const pageCss = ['profile'];
  const pageScripts = [];
%>

<%- include('includes/head', { pageCss }) %>
<%- include('includes/nav') %>
<%- include('includes/header', { description: 'Administra tus ajustes de perfil.' }) %>

<main class="profile-page">
  <div class="container">
    <div class="profile-container">
      <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-error">
          <%= error %>
        </div>
      <% } %>
      
      <% if (typeof success !== 'undefined' && success) { %>
        <div class="alert alert-success">
          <%= success %>
        </div>
      <% } %>
      
      <form action="/users/profile" method="POST" class="profile-form">
        <input type="hidden" name="_method" value="PUT">
        
        <div class="form-section">
          <h2>Información Personal</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label for="firstName">Nombre</label>
              <input 
                type="text" 
                id="firstName" 
                name="firstName" 
                value="<%= userData.firstName %>" 
                required
              >
            </div>
            
            <div class="form-group">
              <label for="lastName">Apellido</label>
              <input 
                type="text" 
                id="lastName" 
                name="lastName" 
                value="<%= userData.lastName %>" 
                required
              >
            </div>
          </div>
          
          <div class="form-group">
            <label for="email">Correo Electrónico</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              value="<%= userData.email %>" 
              disabled
            >
            <div class="input-help">El correo electrónico no se puede cambiar</div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="phone">Número de Teléfono</label>
              <input 
                type="tel" 
                id="phone" 
                name="phone" 
                value="<%= userData.phone %>" 
                required
              >
            </div>
            
            <div class="form-group">
              <label for="church">Iglesia</label>
              <input 
                type="text" 
                id="church" 
                name="church" 
                value="<%= userData.church %>" 
                required
              >
            </div>
          </div>
          
          <div class="form-group">
            <label>¿Eres miembro de la iglesia?</label>
            <div class="radio-group">
              <label>
                <input 
                  type="radio" 
                  name="isMember" 
                  value="yes" 
                  <%= userData.isMember === 'yes' ? 'checked' : '' %> 
                  required
                >
                Sí
              </label>
              <label>
                <input 
                  type="radio" 
                  name="isMember" 
                  value="no" 
                  <%= userData.isMember === 'no' ? 'checked' : '' %> 
                  required
                >
                No
              </label>
            </div>
          </div>
        </div>
        
        <div class="form-section">
          <h2>Contacto de Emergencia</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label for="emergencyName">Nombre del Contacto</label>
              <input 
                type="text" 
                id="emergencyName" 
                name="emergencyName" 
                value="<%= userData.emergencyName %>" 
                required
              >
            </div>
            
            <div class="form-group">
              <label for="emergencyPhone">Teléfono del Contacto</label>
              <input 
                type="tel" 
                id="emergencyPhone" 
                name="emergencyPhone" 
                value="<%= userData.emergencyPhone %>" 
                required
              >
            </div>
          </div>
        </div>
        
        <div class="form-section">
          <h2>Cambiar Contraseña</h2>
          <p class="section-info">Dejar en blanco si no deseas cambiar tu contraseña</p>
          
          <div class="form-group">
            <label for="currentPassword">Contraseña Actual</label>
            <input 
              type="password" 
              id="currentPassword" 
              name="currentPassword"
            >
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="newPassword">Nueva Contraseña</label>
              <input 
                type="password" 
                id="newPassword" 
                name="newPassword"
              >
            </div>
            
            <div class="form-group">
              <label for="confirmPassword">Confirmar Nueva Contraseña</label>
              <input 
                type="password" 
                id="confirmPassword" 
                name="confirmPassword"
              >
            </div>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          <a href="/" class="btn btn-outline">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</main>

<%- include('includes/footer', { pageScripts }) %>